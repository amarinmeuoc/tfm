define("report_partialplan/sendemail",["exports","core_form/modalform","core/notification","core/toast","core/str"],(function(_exports,_modalform,_notification,_toast,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_notification=_interopRequireDefault(_notification);_exports.init=customerid=>{document.querySelectorAll(".boemail").forEach((node=>{node.addEventListener("click",(e=>{traineesFunctionEvent(e,customerid)}))}))};const addNotification=msg=>{(0,_toast.add)(msg)},traineesFunctionEvent=(e,customerid)=>{e.stopPropagation();const element=e.target.closest("button"),modalForm=new _modalform.default({formClass:"\\report_partialplan\\form\\modal_form",args:{list_trainees:element.getAttribute("data-id"),customer:customerid},modalConfig:{title:"Send email to..."},returnFocus:element});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(e=>{const xhr=new XMLHttpRequest;xhr.open("POST","./send_email.php",!0);const formData=new FormData;window.console.log(e.detail.teeditor.text),formData.append("messagebody",e.detail.teeditor.text),formData.append("to",e.detail.emailhidden),formData.append("subject",e.detail.tesubject),xhr.send(formData),xhr.onload=event=>{onLoadFunction(xhr)},xhr.onprogress=event=>{onProgressFunction(event)},xhr.onerror=function(){addNotification("Something went wrong. Please contact with the admin")}}));const onProgressFunction=event=>{event.lengthComputable?window.console.log("Recibidos ".concat(event.loaded," de ").concat(event.total," bytes")):window.console.log("Recibidos ".concat(event.loaded," bytes"))},onLoadFunction=myxhr=>{if(4===myxhr.readyState&&200===myxhr.status){JSON.parse(myxhr.response).result?addNotification("The email has been sent successfully"):addNotification("Something went wrong. Please contact with the admin")}};modalForm.addEventListener(modalForm.events.LOADED,(e=>{e.target.querySelector("button[data-action='save']").textContent="Send Email"})),modalForm.show()}}));

//# sourceMappingURL=sendemail.min.js.map