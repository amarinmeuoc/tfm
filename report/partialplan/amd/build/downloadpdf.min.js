define("report_partialplan/downloadpdf",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=(PDF,customerid)=>{document.querySelectorAll(".courseFinished").forEach((element=>{element.addEventListener("click",(e=>{e.preventDefault();let trainee_list=e.target.getAttribute("data-trainees").split(",");trainee_list=trainee_list.reduce(((arr,elem)=>{const aux=elem.split("_");return[...arr,{group:aux[0],billid:aux[1]}]}),[]);const wbs=e.target.getAttribute("data-wbs");startRequestServer(PDF,customerid,wbs,trainee_list),window.console.log(e.target)}))}))};const startRequestServer=(PDF,customerid,wbs,trainee_list)=>{const xhr=new XMLHttpRequest,url=window.location.protocol+"//"+window.location.hostname+"/webservice/rest/server.php";xhr.open("POST",url,!0);const formData=new FormData,token=document.querySelector("#id_token").value;formData.append("wstoken",token),formData.append("wsfunction","report_partialplan_get_assessment"),formData.append("moodlewsrestformat","json");for(let i=0;i<trainee_list.length;i++){const group=trainee_list[i].group.trim(),billid=trainee_list[i].billid.trim();formData.append("params[".concat(i,"][customerid]"),customerid),formData.append("params[".concat(i,"][group]"),group),formData.append("params[".concat(i,"][billid]"),billid),formData.append("params[".concat(i,"][wbs]"),wbs)}xhr.send(formData),xhr.onload=event=>{onLoadFunction(PDF,xhr)},xhr.onprogress=event=>{onProgressFunction(event)},xhr.onerror=function(){window.console.log("Solicitud fallida")}},onLoadFunction=(PDF,myXhr)=>{if(4===myXhr.readyState&&200===myXhr.status){const res=JSON.parse(myXhr.response);window.console.log(res),async function(PDF,response){const pdfDoc=await PDF.PDFDocument.create(),pdfDataUri=(await pdfDoc.embedFont(PDF.StandardFonts.Helvetica),await pdfDoc.embedFont(PDF.StandardFonts.HelveticaBold),await pdfDoc.saveAsBase64({dataUri:!0}));window.open(pdfDataUri)}(PDF)}},onProgressFunction=event=>{event.lengthComputable?window.console.log("Recibidos ".concat(event.loaded," de ").concat(event.total," bytes")):window.console.log("Recibidos ".concat(event.loaded," bytes"))}}));

//# sourceMappingURL=downloadpdf.min.js.map