define("local_uploaditp/init",["exports","core/modal_delete_cancel","core/modal_events","core/notification"],(function(_exports,_modal_delete_cancel,_modal_events,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.popup=_exports.init=void 0,_modal_delete_cancel=_interopRequireDefault(_modal_delete_cancel),_modal_events=_interopRequireDefault(_modal_events),_notification=_interopRequireDefault(_notification);_exports.init=token=>{const boreset=document.querySelector("#id_removetables");boreset.classList.remove(["btn-secondary"]),boreset.classList.add(["btn-danger"]),boreset.addEventListener("click",(()=>{popup(token)}))};const popup=async token=>{const modal=await _modal_delete_cancel.default.create({title:"Reset tables itp and partialplan",body:"<p>By doing this you confirm you want to remove all data in the tables: <strong>mdl_itp</strong> and <strong>mdl_partialplan</strong>.</p><p>Are you sure?</p>"});modal.getRoot().on(_modal_events.default.delete,(e=>{requestTableReset(token)})),modal.show()};_exports.popup=popup;const requestTableReset=token=>{const xhr=new XMLHttpRequest,url=window.location.protocol+"//"+window.location.hostname+"/webservice/rest/server.php";xhr.open("POST",url,!0);const formData=new FormData;formData.append("wstoken",token),formData.append("wsfunction","local_uploaditp_remove_tables"),formData.append("moodlewsrestformat","json"),formData.append("params[0][op]","yes"),xhr.send(formData),xhr.onload=event=>{onLoadFunction(xhr)},xhr.onprogress=event=>{onProgressFunction(event)},xhr.onerror=function(){window.console.log("Solicitud fallida")}},onProgressFunction=event=>{event.lengthComputable?window.console.log("Recibidos ".concat(event.loaded," de ").concat(event.total," bytes")):window.console.log("Recibidos ".concat(event.loaded," bytes"))},onLoadFunction=myXhr=>{if(4===myXhr.readyState&&200===myXhr.status){!0===JSON.parse(myXhr.response)[0].result&&_notification.default.addNotification({message:"Tables have been successfully reset",type:"info"})}}}));

//# sourceMappingURL=init.min.js.map