define("block_itp/showAss",["exports","core/notification","core/templates"],(function(_exports,_notification,_templates){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};_exports.init=(token,email,firstname,lastname)=>{let customer,group,billid,linkass=document.querySelectorAll(".linkass");const showAssessmentList=event=>{showAssessmentListFunction(event,token,email,firstname,lastname)};linkass.length>0&&null!==linkass?(customer=linkass[0].attributes.customer.value,group=linkass[0].attributes.group.value,billid=linkass[0].attributes.billid.value,linkass.forEach((link=>{link.addEventListener("click",showAssessmentList)}))):(customer=null,group=null,billid=null)};const showAssessmentListFunction=(e,token,email,firstname,lastname)=>{e.preventDefault();let courseid=e.target.attributes.courseid.value;const xhr=new XMLHttpRequest,url=window.location.protocol+"//"+window.location.hostname+"/webservice/rest/server.php";xhr.open("POST",url,!0);const formData=new FormData;formData.append("wstoken",token),formData.append("wsfunction","block_itp_get_assessment_details"),formData.append("moodlewsrestformat","json"),formData.append("params[0][courseid]",courseid),formData.append("params[0][email]",email),xhr.send(formData),xhr.onload=event=>{onLoadFunction(xhr,firstname,lastname,token)},xhr.onprogress=event=>{onProgressFunction(event)},xhr.onerror=function(){window.console.log("Solicitud fallida")}},onLoadFunction=(myXhr,firstname,lastname,token)=>{if(4===myXhr.readyState&&200===myXhr.status){const res=JSON.parse(myXhr.response),formattedData={token:token,customer:customer,group:group,billid:billid,user:{firstname:firstname,lastname:lastname},assessmentDetails:res.map((item=>({kpi:item.kpi,id:item.id,coursename:item.coursename,type:item.type,score:item.score,feedback:item.feedback,timemodified:item.timemodified})))};response=formattedData,_templates.default.renderForPromise("block_itp/assessmentDetails",response).then((_ref=>{let{html:html,js:js}=_ref;document.querySelector(".block_itp_content").innerHTML="",window.scrollTo(0,0),_templates.default.appendNodeContents(".block_itp_content",html,js)})).catch((error=>(0,_notification.exception)(error)))}var response},onProgressFunction=event=>{event.lengthComputable?window.console.log("Recibidos ".concat(event.loaded," de ").concat(event.total," bytes")):window.console.log("Recibidos ".concat(event.loaded," bytes"))}}));

//# sourceMappingURL=showAss.min.js.map