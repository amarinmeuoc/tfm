{"version":3,"file":"javascript.min.js","sources":["../src/javascript.js"],"sourcesContent":["import {exception as displayException} from 'core/notification';\nimport Templates from 'core/templates';\nexport const init = (elemId,email,customer) => {\n    let linkatt=document.querySelector('#linkatt-'+elemId);\n    let linkass=document.querySelector('#linkass-'+elemId);\n    let boback=document.querySelector('.back');\n    if (boback!==null)\n      {window.console.log(boback);\n      window.console.log(customer);\n      }\n    //Show the assessment in detail\n    let showAssessmentList=(e)=>{\n      e.preventDefault();\n      let courseid=e.target.attributes.courseid.value;\n      const xhr=new XMLHttpRequest();\n      const url='https://'+window.location.hostname+'/webservice/rest/server.php';\n      xhr.open('POST',url,true);\n      const formData= new FormData();\n      formData.append('wstoken','e7c69cd9f8136c608e22b90d760cff7a');\n      formData.append('wsfunction','block_itp_get_assessment_details');\n      formData.append('moodlewsrestformat','json');\n      formData.append('params[0][courseid]',courseid);\n      formData.append('params[0][email]',email);\n\n      xhr.send(formData);\n      xhr.onload = function() {\n          if (this.readyState=== 4 && this. status === 200){\n              const res=JSON.parse(this.response);\n              const formattedData = {\n                customer:customer,\n               \n                assessmentDetails: res.map(item => {\n                  // Customize object properties for the template as needed\n                  return {\n                    // Example:\n                    kpi: item.kpi,\n                    id: item.id,\n                    coursename:item.coursename,\n                    type:item.type,\n                    score:item.score,\n                    timemodified:item.timemodified\n                    // ... add other properties\n                  };\n                })\n              }\n              showTemplateAssessment(formattedData);\n\n          }\n        };\n        xhr.onprogress = function(event) {\n          if (event.lengthComputable) {\n            window.console.log(`Recibidos ${event.loaded} de ${event.total} bytes`);\n          } else {\n            window.console.log(`Recibidos ${event.loaded} bytes`); // sin Content-Length\n          }\n        \n        };\n        \n        xhr.onerror = function() {\n          window.console.log(\"Solicitud fallida\");\n        };\n  }\n\n  if (linkass!==null)\n    linkass.addEventListener('click',showAssessmentList);\n\n    \n\n    function showTemplateAssessment(response){\n\n        Templates.renderForPromise('block_itp/assessmentDetails',response)\n        .then(({html,js})=>{\n          Templates.appendNodeContents('.block_itp_content',html,js);\n          const tableItp=document.querySelector('.block_itp_table');\n          tableItp.remove();\n        })\n        .catch((error)=>displayException(error));\n    }\n\n    function showITP(response){\n\n      Templates.renderForPromise('block_itp/itpcontent',response)\n      .then(({html,js})=>{\n        Templates.appendNodeContents('.block_itp_content',html,js);\n        const assessmentDetail=document.querySelector('.assessment_detail');\n        assessmentDetail.remove();\n          window.console.log(response);\n      })\n      .catch((error)=>displayException(error));\n  }\n\n};"],"names":["elemId","email","customer","document","querySelector","linkass","boback","window","console","log","addEventListener","e","preventDefault","courseid","target","attributes","value","xhr","XMLHttpRequest","url","location","hostname","open","formData","FormData","append","send","onload","this","readyState","status","res","JSON","parse","response","formattedData","assessmentDetails","map","item","kpi","id","coursename","type","score","timemodified","renderForPromise","then","_ref","html","js","appendNodeContents","remove","catch","error","onprogress","event","lengthComputable","loaded","total","onerror"],"mappings":"6RAEoB,CAACA,OAAOC,MAAMC,YAClBC,SAASC,cAAc,YAAYJ,YAC3CK,QAAQF,SAASC,cAAc,YAAYJ,QAC3CM,OAAOH,SAASC,cAAc,SACrB,OAATE,SACDC,OAAOC,QAAQC,IAAIH,QACpBC,OAAOC,QAAQC,IAAIP,WAuDT,OAAVG,SACFA,QAAQK,iBAAiB,SArDDC,IACtBA,EAAEC,qBACEC,SAASF,EAAEG,OAAOC,WAAWF,SAASG,YACpCC,IAAI,IAAIC,eACRC,IAAI,WAAWZ,OAAOa,SAASC,SAAS,8BAC9CJ,IAAIK,KAAK,OAAOH,KAAI,SACdI,SAAU,IAAIC,SACpBD,SAASE,OAAO,UAAU,oCAC1BF,SAASE,OAAO,aAAa,oCAC7BF,SAASE,OAAO,qBAAqB,QACrCF,SAASE,OAAO,sBAAsBZ,UACtCU,SAASE,OAAO,mBAAmBxB,OAEnCgB,IAAIS,KAAKH,UACTN,IAAIU,OAAS,cACc,IAAnBC,KAAKC,YAAoC,MAAjBD,KAAME,OAAe,OACvCC,IAAIC,KAAKC,MAAML,KAAKM,UACpBC,cAAgB,CACpBjC,SAASA,SAETkC,kBAAmBL,IAAIM,KAAIC,OAElB,CAELC,IAAKD,KAAKC,IACVC,GAAIF,KAAKE,GACTC,WAAWH,KAAKG,WAChBC,KAAKJ,KAAKI,KACVC,MAAML,KAAKK,MACXC,aAAaN,KAAKM,kBA4BFV,SAvBCC,iCAyBnBU,iBAAiB,8BAA8BX,UACxDY,MAAKC,WAACC,KAACA,KAADC,GAAMA,4BACDC,mBAAmB,qBAAqBF,KAAKC,IACxC9C,SAASC,cAAc,oBAC7B+C,YAEVC,OAAOC,QAAQ,2BAAiBA,aARLnB,UAnB5BjB,IAAIqC,WAAa,SAASC,OACpBA,MAAMC,iBACRjD,OAAOC,QAAQC,wBAAiB8C,MAAME,sBAAaF,MAAMG,iBAEzDnD,OAAOC,QAAQC,wBAAiB8C,MAAME,mBAK1CxC,IAAI0C,QAAU,WACZpD,OAAOC,QAAQC,IAAI"}