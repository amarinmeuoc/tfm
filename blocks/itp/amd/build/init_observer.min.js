define("block_itp/init_observer",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=(token,customercode)=>{const bosubmit=document.querySelector("#fitem_id_bosubmit"),groupSelect=document.querySelector("#id_selgroup"),selListTrainees=document.querySelector("#id_list_trainees");bosubmit.classList.remove("row"),window.console.log("hola"),updateListTrainees(customercode,groupSelect,selListTrainees,token),groupSelect.addEventListener("change",(ev=>{updateListTrainees(customercode,groupSelect,selListTrainees,token)}),token,customercode)};const updateListTrainees=(customercode,groupSelect,listTrainees,token)=>{let xhr=new XMLHttpRequest;const url=window.location.protocol+"//"+window.location.hostname+"/webservice/rest/server.php",selectedCustomer=customercode,selectedGroup=groupSelect.options[groupSelect.selectedIndex].textContent;xhr.open("POST",url,!0);const formData=new FormData;formData.append("wstoken",token),formData.append("wsfunction","block_itp_get_trainee_list"),formData.append("moodlewsrestformat","json"),formData.append("params[0][customercode]",selectedCustomer),formData.append("params[0][groupname]",selectedGroup),xhr.send(formData),xhr.onload=()=>{reloadTraineeList(xhr,listTrainees)},xhr.onerror=function(){window.console.log("Solicitud fallida")}},reloadTraineeList=(xhr,listTrainees)=>{if(4===xhr.readyState&&200===xhr.status&&xhr.response){const list_trainees=JSON.parse(xhr.response);window.console.log(list_trainees),removeOptions(listTrainees),list_trainees.map((obj=>{const opt=document.createElement("option");opt.value=obj.billid,opt.textContent=obj.groupname+"_"+obj.billid+" "+obj.firstname+", "+obj.lastname,listTrainees.appendChild(opt)}));let activeSpan=document.querySelector('#fitem_id_list_trainees>div>div>span[role="option"]');if(null!==activeSpan&&list_trainees.length>0){activeSpan.setAttribute("data-value",0===list_trainees.length?"":list_trainees[0].billid);const span=document.createElement("span");span.setAttribute("aria-hidden",!0),span.textContent="Ã— ",activeSpan.innerHTML="",activeSpan.appendChild(span),activeSpan.innerHTML+=list_trainees[0].groupname+"_"+list_trainees[0].billid+" "+list_trainees[0].firstname+", "+list_trainees[0].lastname}}},removeOptions=selectElement=>{var i;for(i=selectElement.options.length-1;i>=0;i--)selectElement.remove(i)}}));

//# sourceMappingURL=init_observer.min.js.map